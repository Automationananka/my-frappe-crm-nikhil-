# Dockerfile for ERPNext on Railway with MySQL
ARG CACHE_BUSTER=v14
ARG ERPNEXT_VERSION=v15

FROM frappe/erpnext:${ERPNEXT_VERSION}

# Switch to root for installation
USER root

# Force cache bust
RUN echo "--- Forcing rebuild ${CACHE_BUSTER} ---"

# Copy the fixed entrypoint script
COPY entrypoint.v2.sh /entrypoint.v2.sh

# Make it executable
RUN chmod +x /entrypoint.v2.sh

# Expose port
EXPOSE 8000

# Set entrypoint
ENTRYPOINT ["/entrypoint.v2.sh"]
